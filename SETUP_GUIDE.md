# AccuSync ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
## åˆ¥ã®ãƒ‘ã‚½ã‚³ãƒ³ã§ã®èµ·å‹•æ‰‹é †

ã“ã®ã‚¬ã‚¤ãƒ‰ã¯ã€AccuSyncã‚·ã‚¹ãƒ†ãƒ ã‚’åˆ¥ã®ãƒ‘ã‚½ã‚³ãƒ³ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒï¼‰ã«ç§»è¡Œã™ã‚‹éš›ã®æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## ğŸ“‹ å‰ææ¡ä»¶

ä»¥ä¸‹ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- **Docker Desktop** (Windows/Mac) ã¾ãŸã¯ **Docker + Docker Compose** (Linux)
- **Git** (ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å–å¾—ç”¨ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³)

---

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®é…ç½®

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä»»æ„ã®å ´æ‰€ã«ã‚³ãƒ”ãƒ¼
# ä¾‹: C:\Projects\AccuSync ã¾ãŸã¯ /home/user/AccuSync
```

### ã‚¹ãƒ†ãƒƒãƒ—2: ç’°å¢ƒå¤‰æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

`.env.example`ã‹ã‚‰`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
# Linux/Mac
cd AccuSync
cp .env.example .env

# Windows (PowerShell)
cd AccuSync
copy .env.example .env
```

**é‡è¦ãªç’°å¢ƒå¤‰æ•°:**
```.env
# AIè¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
AI_PROVIDER=openai
OPENAI_API_KEY=your-api-key-here

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆå¤‰æ›´ä¸è¦ï¼‰
POSTGRES_USER=accusync
POSTGRES_PASSWORD=accusync_pass
POSTGRES_DB=accusync

# Supabaseï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ»ä¸è¦ï¼‰
# ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒã§æ¥ç¶šã§ããªã„å ´åˆã¯ç„¡è¦–ã—ã¦OK
# ãƒ­ãƒ¼ã‚«ãƒ«DBã§å‹•ä½œã—ã¾ã™
```

### ã‚¹ãƒ†ãƒƒãƒ—3: Dockerã‚µãƒ¼ãƒ“ã‚¹ã®èµ·å‹•

```bash
# ã™ã¹ã¦ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•
docker-compose up -d --build

# ãƒ­ã‚°ã‚’ç¢ºèªï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
docker-compose logs -f
```

èµ·å‹•ã™ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆ7å€‹ï¼‰ï¼š
- âœ… **api** - FastAPIãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (port 8100)
- âœ… **celery_worker** - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¿ã‚¹ã‚¯å‡¦ç†
- âœ… **celery_beat** - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ãƒ¼
- âœ… **db** - PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ (port 5433)
- âœ… **redis** - ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚­ãƒ¥ãƒ¼ (port 6380)
- âœ… **minio** - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ (port 9100/9101)
- âœ… **frontend** - Next.jsãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (port 3100)

### ã‚¹ãƒ†ãƒƒãƒ—4: æ©Ÿç¨®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**é‡è¦:** ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒã«ä¾å­˜ã—ãªã„æ©Ÿç¨®æŠ½å‡ºãƒ»ã‚µã‚¤ã‚ºå–å¾—ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚

#### Linux/Mac:
```bash
chmod +x setup-device-master.sh
./setup-device-master.sh
```

#### Windows:
```cmd
setup-device-master.bat
```

ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒå®Ÿè¡Œã™ã‚‹å†…å®¹ï¼š
1. âœ… `device_attributes`ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
2. âœ… ä¸»è¦90æ©Ÿç¨®ã®ã‚µã‚¤ã‚ºæƒ…å ±ã‚’ç™»éŒ²
   - iPhoneç³»ï¼ˆ30æ©Ÿç¨®ï¼‰
   - Galaxyç³»ï¼ˆ18æ©Ÿç¨®ï¼‰
   - AQUOSç³»ï¼ˆ17æ©Ÿç¨®ï¼‰
   - Xperiaç³»ï¼ˆ11æ©Ÿç¨®ï¼‰
   - Pixelç³»ï¼ˆ10æ©Ÿç¨®ï¼‰
   - ãã®ä»–ï¼ˆOPPO, Xiaomi, arrowsç­‰ï¼‰
3. âœ… ã‚µãƒ¼ãƒ“ã‚¹ã®å†èµ·å‹•

### ã‚¹ãƒ†ãƒƒãƒ—5: å‹•ä½œç¢ºèª

#### 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
```
http://localhost:3100
```

#### 2. APIå‹•ä½œç¢ºèª
```bash
curl http://localhost:8100/api/v1/health
```

æœŸå¾…ã•ã‚Œã‚‹å¿œç­”ï¼š
```json
{"status": "healthy"}
```

#### 3. æ©Ÿç¨®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
```bash
docker-compose exec db psql -U accusync -d accusync
```

PostgreSQLæ¥ç¶šå¾Œï¼š
```sql
-- ç™»éŒ²ä»¶æ•°ç¢ºèª
SELECT COUNT(*) FROM device_attributes;

-- ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
SELECT brand, device_name, size_category
FROM device_attributes
LIMIT 10;

-- ç‰¹å®šæ©Ÿç¨®ã®æ¤œç´¢
SELECT * FROM device_attributes
WHERE device_name ILIKE '%iPhone 15%';

-- çµ‚äº†
\q
```

---

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: Dockerã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ãªã„

**ç¢ºèªäº‹é …:**
```bash
# Docker DesktopãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
docker version

# ãƒãƒ¼ãƒˆã®ç«¶åˆç¢ºèª
docker-compose ps
```

**è§£æ±ºç­–:**
- Docker Desktopã‚’å†èµ·å‹•
- ä½¿ç”¨ãƒãƒ¼ãƒˆï¼ˆ3100, 8100, 5433, 6380, 9100, 9101ï¼‰ãŒç©ºã„ã¦ã„ã‚‹ã‹ç¢ºèª

### å•é¡Œ2: ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

**ã‚¨ãƒ©ãƒ¼ä¾‹:**
```
alembic.util.exc.CommandError: Can't locate revision identified by 'xxxxxx'
```

**è§£æ±ºç­–:**
```bash
# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¦å†ä½œæˆ
docker-compose down -v
docker-compose up -d
./setup-device-master.sh  # ã¾ãŸã¯ .bat
```

### å•é¡Œ3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒAPIã«æ¥ç¶šã§ããªã„

**ç¢ºèª:**
```bash
# APIãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª
curl http://localhost:8100/api/v1/health

# ãƒ­ã‚°ã‚’ç¢ºèª
docker-compose logs api
```

**è§£æ±ºç­–:**
```bash
# APIã‚’å†èµ·å‹•
docker-compose restart api
```

### å•é¡Œ4: Supabaseæ¥ç¶šã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**ç—‡çŠ¶:**
```
âš ï¸ Supabase connection failed: [Errno -2] Name or service not known
```

**å¯¾å‡¦:**
ã“ã‚Œã¯**æ­£å¸¸ã§ã™**ã€‚Supabaseã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ã§ã€æ¥ç¶šã§ããªãã¦ã‚‚ã‚·ã‚¹ãƒ†ãƒ ã¯å‹•ä½œã—ã¾ã™ã€‚

- âœ… ãƒ­ãƒ¼ã‚«ãƒ«DBï¼ˆdevice_attributesï¼‰ã‹ã‚‰æ©Ÿç¨®æƒ…å ±ã‚’å–å¾—
- âœ… æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã‚µã‚¤ã‚ºæŠ½å‡º
- âŒ Supabaseã‚¯ãƒ©ã‚¦ãƒ‰ã¯ä½¿ç”¨ä¸å¯ï¼ˆå½±éŸ¿ãªã—ï¼‰

---

## ğŸ“Š æ©Ÿèƒ½ç¢ºèªãƒ†ã‚¹ãƒˆ

### 1. CSVã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ

1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«ã‚¢ã‚¯ã‚»ã‚¹: `http://localhost:3100`
2. ã€Œãƒ‡ãƒ¼ã‚¿å–ã‚Šè¾¼ã¿ã€ãƒšãƒ¼ã‚¸ã«ç§»å‹•
3. ãƒ†ã‚¹ãƒˆCSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆ`testdata/sample.csv`ï¼‰
4. ãƒãƒƒãƒ”ãƒ³ã‚°ç”»é¢ã§åˆ—ã‚’è¨­å®š
5. ã‚¤ãƒ³ãƒãƒ¼ãƒˆå®Ÿè¡Œ

### 2. æ©Ÿç¨®æŠ½å‡ºãƒ†ã‚¹ãƒˆ

ã‚µãƒ³ãƒ—ãƒ«CSVã«ä»¥ä¸‹ã®ã‚ˆã†ãªå•†å“åã‚’å«ã‚ã¦ç¢ºèªï¼š
- `æ‰‹å¸³å‹ã‚«ãƒãƒ¼/iPhone 15 Pro_i6`
- `ãƒãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹(AQUOS wish4)`
- `æ‰‹å¸³å‹ã‚«ãƒãƒ¼/Galaxy A54_L`

æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œï¼š
- âœ… æ©Ÿç¨®åãŒè‡ªå‹•æ¤œå‡ºã•ã‚Œã‚‹ï¼ˆ`iPhone 15 Pro`, `AQUOS wish4`, `Galaxy A54`ï¼‰
- âœ… ã‚µã‚¤ã‚ºãŒæŠ½å‡ºã•ã‚Œã‚‹ï¼ˆæ‰‹å¸³å‹ã®ã¿: `i6`, `L`ç­‰ï¼‰
- âœ… å•†å“ã‚¿ã‚¤ãƒ—ãŒåˆ†é¡ã•ã‚Œã‚‹ï¼ˆ`ãƒãƒ¼ãƒ‰ã‚±ãƒ¼ã‚¹`, `æ‰‹å¸³å‹ã‚«ãƒãƒ¼`ï¼‰

---

## ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã‚¢

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆ
docker-compose exec db pg_dump -U accusync accusync > backup_$(date +%Y%m%d).sql

# ç¢ºèª
ls -lh backup_*.sql
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒªã‚¹ãƒˆã‚¢

```bash
# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢
docker-compose exec -T db psql -U accusync -d accusync < backup_20251031.sql
```

---

## ğŸ¯ ãƒãƒ¼ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®ãƒã‚¤ãƒ³ãƒˆ

### âœ… ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éä¾å­˜ã®æ©Ÿèƒ½

1. **æ©Ÿç¨®æŠ½å‡º** - æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ™ãƒ¼ã‚¹
2. **ã‚µã‚¤ã‚ºå–å¾—** - ãƒ­ãƒ¼ã‚«ãƒ«DBï¼ˆdevice_attributesï¼‰ã‹ã‚‰å–å¾—
3. **å•†å“ç®¡ç†** - å…¨ã¦ãƒ­ãƒ¼ã‚«ãƒ«PostgreSQLã§å®Œçµ
4. **æ³¨æ–‡å‡¦ç†** - å¤–éƒ¨APIã«ä¾å­˜ã—ãªã„

### âš ï¸ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¾å­˜ã®æ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

1. **AIæ©Ÿèƒ½** - OpenAI/Claude APIã‚­ãƒ¼ãŒå¿…è¦
   - é¡§å®¢ã‚¿ã‚¤ãƒ—åˆ¤å®š
   - ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯
   - è‡ªå‹•ãƒãƒƒãƒ”ãƒ³ã‚°

   â†’ `.env`ã§APIã‚­ãƒ¼ã‚’è¨­å®šã™ã‚Œã°åˆ©ç”¨å¯èƒ½

2. **Supabaseã‚¯ãƒ©ã‚¦ãƒ‰** - å¤–éƒ¨æ©Ÿç¨®ãƒã‚¹ã‚¿ãƒ¼DB
   - ãƒ­ãƒ¼ã‚«ãƒ«DBã§ä»£æ›¿å¯èƒ½
   - å½±éŸ¿ãªã—

---

## ğŸ“ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

ç§»è¡Œå®Œäº†æ™‚ã®ç¢ºèªé …ç›®ï¼š

- [ ] Docker DesktopãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹
- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `docker-compose up -d`ã§ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•
- [ ] `setup-device-master.sh(.bat)`ã‚’å®Ÿè¡Œæ¸ˆã¿
- [ ] `http://localhost:3100`ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ©Ÿç¨®ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒç™»éŒ²ã•ã‚Œã¦ã„ã‚‹
- [ ] ãƒ†ã‚¹ãƒˆCSVã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆãŒæˆåŠŸã™ã‚‹

---

## ğŸ’¡ è¿½åŠ æƒ…å ±

### ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

- **ãƒ¡ãƒ¢ãƒª**: æœ€ä½4GBã€æ¨å¥¨8GBä»¥ä¸Š
- **ãƒ‡ã‚£ã‚¹ã‚¯ç©ºãå®¹é‡**: æœ€ä½10GB
- **OS**: Windows 10/11, macOS 11+, Linux (Ubuntu 20.04+)

### ãƒãƒ¼ãƒˆä½¿ç”¨çŠ¶æ³

| ã‚µãƒ¼ãƒ“ã‚¹ | ãƒãƒ¼ãƒˆ | ç”¨é€” |
|---------|--------|------|
| Frontend | 3100 | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |
| API | 8100 | RESTful API |
| Database | 5433 | PostgreSQL |
| Redis | 6380 | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ»ã‚­ãƒ¥ãƒ¼ |
| MinIO | 9100 | S3äº’æ›ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ |
| MinIO Console | 9101 | ç®¡ç†ç”»é¢ |

### ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆã¯ã€ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š

- `CLAUDE.md` - å…¨ä½“çš„ãªé–‹ç™ºã‚¬ã‚¤ãƒ‰
- `SESSION_2025-10-31.md` - æœ€æ–°ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨˜éŒ²
- `PROGRESS.md` - é–‹ç™ºé€²æ—ã¨å®Ÿè£…æ¸ˆã¿æ©Ÿèƒ½

---

**ä½œæˆæ—¥**: 2025-10-31
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**å¯¾è±¡**: AccuSync v2.0+
